# =============================================================================
# .NET Application Stack - Environment Configuration
# =============================================================================
# Copy this file to .env and customize for your deployment:
#   cp .env.example .env
#   nano .env

# -----------------------------------------------------------------------------
# Stack Configuration
# -----------------------------------------------------------------------------
STACK_NAME=dotnet-app
RESTART_POLICY=unless-stopped

# -----------------------------------------------------------------------------
# Application Image
# -----------------------------------------------------------------------------
# Option 1: Use pre-built image from registry
DOTNET_IMAGE=your-registry.com/your-dotnet-app:latest

# Option 2: Build from source (uncomment BUILD_CONTEXT to enable)
# BUILD_CONTEXT=./app
# DOCKERFILE=Dockerfile

# -----------------------------------------------------------------------------
# Domain Configuration
# -----------------------------------------------------------------------------
DOMAIN=app.yourdomain.com

# ASP.NET Core Environment
ASPNETCORE_ENVIRONMENT=Production
APP_PORT=8080

# Health Check
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=5
HEALTH_CHECK_START_PERIOD=60s

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
# Choose your database: postgres (default), sqlserver, or mysql

# PostgreSQL (default)
POSTGRES_VERSION=16
POSTGRES_DB=dotnetdb
POSTGRES_USER=dotnetuser
POSTGRES_PASSWORD=CHANGE_ME_generate_strong_password_min_20_chars

# Connection String (PostgreSQL)
DB_CONNECTION_STRING=Host=postgres;Port=5432;Database=${POSTGRES_DB};Username=${POSTGRES_USER};Password=${POSTGRES_PASSWORD}

# --- SQL Server (enable profile: docker compose --profile sqlserver up) ---
# SQLSERVER_VERSION=2022-latest
# SQLSERVER_SA_PASSWORD=YourStrong!Passw0rd_Min8Chars
# SQLSERVER_EDITION=Developer
# DB_CONNECTION_STRING=Server=sqlserver;Database=DotNetDb;User Id=sa;Password=${SQLSERVER_SA_PASSWORD};TrustServerCertificate=true

# --- MySQL (enable profile: docker compose --profile mysql up) ---
# MYSQL_VERSION=8.4
# MYSQL_ROOT_PASSWORD=CHANGE_ME_root_password
# MYSQL_DATABASE=dotnetdb
# MYSQL_USER=dotnetuser
# MYSQL_PASSWORD=CHANGE_ME_user_password
# DB_CONNECTION_STRING=Server=mysql;Database=${MYSQL_DATABASE};Uid=${MYSQL_USER};Pwd=${MYSQL_PASSWORD}

# -----------------------------------------------------------------------------
# JWT Configuration (for authentication)
# -----------------------------------------------------------------------------
JWT_SECRET=CHANGE_ME_generate_minimum_64_character_secret_key_here
JWT_ISSUER=https://${DOMAIN}
JWT_AUDIENCE=https://${DOMAIN}
JWT_EXPIRY_MINUTES=60

# To generate JWT secret:
#   openssl rand -base64 64

# -----------------------------------------------------------------------------
# API Configuration
# -----------------------------------------------------------------------------
API_KEY=your_api_key_if_needed

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
CORS_ALLOWED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# -----------------------------------------------------------------------------
# Email Configuration (SMTP)
# -----------------------------------------------------------------------------
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-specific-password
SMTP_FROM=noreply@yourdomain.com

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
LOG_LEVEL=Information
# Options: Trace, Debug, Information, Warning, Error, Critical

# -----------------------------------------------------------------------------
# Resource Limits
# -----------------------------------------------------------------------------
MEMORY_LIMIT=1G
CPU_LIMIT=0.5

# -----------------------------------------------------------------------------
# Traefik Integration
# -----------------------------------------------------------------------------
TRAEFIK_NETWORK=traefik-net

# -----------------------------------------------------------------------------
# Migrations
# -----------------------------------------------------------------------------
RUN_MIGRATIONS=false
# Set to true in deploy.sh to run EF Core migrations automatically

# -----------------------------------------------------------------------------
# Security Notes
# -----------------------------------------------------------------------------
# 1. NEVER commit .env to version control
# 2. Use strong passwords (minimum 20 characters)
# 3. JWT_SECRET must be at least 64 characters
# 4. Rotate secrets regularly
# 5. Use different passwords for each environment (dev/staging/prod)

# -----------------------------------------------------------------------------
# Password Generation Commands
# -----------------------------------------------------------------------------
# Strong password:    openssl rand -base64 32
# JWT secret:         openssl rand -base64 64
# API key:            openssl rand -hex 32
