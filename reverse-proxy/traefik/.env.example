# =============================================================================
# Traefik Reverse Proxy - Environment Configuration
# =============================================================================
# Copy this file to .env and customize:
#   cp .env.example .env
#   nano .env

# -----------------------------------------------------------------------------
# Traefik Version
# -----------------------------------------------------------------------------
TRAEFIK_VERSION=v3.3
# Check latest: https://github.com/traefik/traefik/releases

# -----------------------------------------------------------------------------
# Basic Configuration
# -----------------------------------------------------------------------------
RESTART_POLICY=unless-stopped
TIMEZONE=UTC

# Network name (must match across all stacks)
TRAEFIK_NETWORK=traefik-net

# -----------------------------------------------------------------------------
# Let's Encrypt Configuration
# -----------------------------------------------------------------------------
# REQUIRED: Email for Let's Encrypt certificate notifications
ACME_EMAIL=admin@yourdomain.com

# -----------------------------------------------------------------------------
# Dashboard Configuration
# -----------------------------------------------------------------------------
# Domain for accessing Traefik dashboard (optional)
TRAEFIK_DASHBOARD_DOMAIN=traefik.yourdomain.com

# Dashboard port (default: 8080)
# In production, consider removing this or restricting with firewall
DASHBOARD_PORT=8080

# Basic Auth for dashboard (HIGHLY RECOMMENDED for production)
# Generate with: echo $(htpasswd -nb admin your_password)
# Or use: htpasswd -nb username password
TRAEFIK_DASHBOARD_AUTH=

# Allow insecure API access (set to false in production)
API_INSECURE=true

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
# Log levels: DEBUG, INFO, WARN, ERROR, FATAL, PANIC
TRAEFIK_LOG_LEVEL=INFO

# Log formats: common, json
LOG_FORMAT=common
ACCESS_LOG_FORMAT=common

# -----------------------------------------------------------------------------
# Metrics & Monitoring (Prometheus)
# -----------------------------------------------------------------------------
# Enable Prometheus metrics endpoint
ENABLE_METRICS=false

# If enabled, metrics available at:
#   http://localhost:8080/metrics (local)
#   https://traefik.yourdomain.com/metrics (if dashboard domain configured)

# -----------------------------------------------------------------------------
# Security Headers (configured in config/middlewares.yml)
# -----------------------------------------------------------------------------
# These are defined in dynamic configuration files
# See: config/middlewares.yml and config/tls.yml

# -----------------------------------------------------------------------------
# Advanced Configuration
# -----------------------------------------------------------------------------
# Rate limiting (configured per service in labels)
# See documentation: https://doc.traefik.io/traefik/middlewares/http/ratelimit/

# Circuit breaker (configured per service in labels)
# See documentation: https://doc.traefik.io/traefik/middlewares/http/circuitbreaker/

# IP Whitelist (configured per service in labels)
# See documentation: https://doc.traefik.io/traefik/middlewares/http/ipwhitelist/

# -----------------------------------------------------------------------------
# Example Dashboard Auth Generation
# -----------------------------------------------------------------------------
# Method 1: Using htpasswd (from apache2-utils package)
#   sudo apt-get install apache2-utils
#   htpasswd -nb admin your_password
#
# Method 2: Using Docker
#   docker run --rm httpd:alpine htpasswd -nb admin your_password
#
# Method 3: Using openssl
#   echo $(htpasswd -nb admin $(openssl rand -base64 12))
#
# Copy the output to TRAEFIK_DASHBOARD_AUTH

# -----------------------------------------------------------------------------
# Production Security Checklist
# -----------------------------------------------------------------------------
# - [ ] Set TRAEFIK_DASHBOARD_AUTH (enable authentication)
# - [ ] Set API_INSECURE=false
# - [ ] Remove or firewall DASHBOARD_PORT=8080
# - [ ] Configure rate limiting for public services
# - [ ] Enable ENABLE_METRICS=true for monitoring
# - [ ] Set up IP whitelisting for sensitive endpoints
# - [ ] Review and customize security headers in config/middlewares.yml
# - [ ] Regularly update TRAEFIK_VERSION
# - [ ] Backup letsencrypt/acme.json regularly

# -----------------------------------------------------------------------------
# Notes
# -----------------------------------------------------------------------------
# - Never commit .env to version control
# - Keep acme.json with 600 permissions (handled by deploy.sh)
# - Backup acme.json before major updates
# - Monitor certificate expiration in dashboard
